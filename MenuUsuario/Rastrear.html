<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rastrear Envío</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="MenuUsuario.css">
    <script src="../Inicio de sesion o Registro/auth.js"></script>
    <script src="userNameUsuario.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <header class="header">
                <h1 class="Logo">
                    <span class="Trace">TRACE&</span><span class="Track">TRACK</span>
                </h1>
            </header>
        </div>
    </nav>

    <main class="container text-center">
        <h2 class="mb-4">Paquetes enviados</h2>
        <table class="table table-striped">
            <!-- Encabezado de la tabla -->
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Descripcion</th>
                    <th>Destinatario</th>
                </tr>
            </thead>
            <!-- Cuerpo de la tabla donde se cargarán los usuarios -->
            <tbody id="envioTableBody">
                <!-- Aquí se llenarán los datos de los usuarios con JavaScript -->
            </tbody>
        </table>
        <h2 class="mb-4">Paquetes a recibir</h2>
        <table class="table table-striped">
            <!-- Encabezado de la tabla -->
            <thead>
                <tr>
                    <th>ID Pedido</th>
                    <th>Descripcion</th>
                    <th>Remitente</th>
                </tr>
            </thead>
            <!-- Cuerpo de la tabla donde se cargarán los usuarios -->
            <tbody id="reciboTableBody">
                <!-- Aquí se llenarán los datos de los usuarios con JavaScript -->
            </tbody>
        </table>
        <div class="search-bar">
            <button class="btn btn-success mt-2" onclick="window.location.href='MenuUsuario.html'">Regresar</button>
        </div>
    </main>

    <script src="script.js"></script>

    <!-- Burbuja de saludo flotante -->
    <div id="saludoBubble" class="saludo-bubble">
        ¡Hola! Bienvenido <span id="user-name-display">Cargando...</span>
    </div>

    <!-- Script para cargar los paquetes enviados desde la base de datos -->
    <script>
        // Realizar una solicitud para obtener los usuarios desde el servidor
        fetch('MostrarEnviados.php', { method: 'POST' })  // Realizar una solicitud POST a 'MostrarUsuarios.php'
            .then(response => response.json())  // Convierte la respuesta en formato JSON
            .then(data => {
                console.log(data); // Muestra los datos obtenidos en la consola para depuración
    
                // Obtener el contenedor donde se insertarán los usuarios en la tabla
                const contenedor = document.getElementById('envioTableBody');
    
                // Verificar que 'data' es un array y contiene usuarios
                if (Array.isArray(data) && data.length > 0) {
                    // Recorrer los usuarios y crear una fila en la tabla por cada uno
                    data.forEach(envio => {
                        const row = document.createElement('tr');
                        
                        // Crear celdas para los datos de cada usuario
                        const cellID = document.createElement('td');
                        cellID.textContent = envio.ID;
    
                        const cellDescripcion = document.createElement('td');
                        cellDescripcion.textContent = envio.Descripcion;
    
                        const cellDestinatario = document.createElement('td');
                        cellDestinatario.textContent = envio.Destinatario;
    
                        // Añadir las celdas a la fila
                        row.appendChild(cellID);
                        row.appendChild(cellDescripcion);
                        row.appendChild(cellDestinatario);
    
                        // Añadir la fila a la tabla
                        contenedor.appendChild(row);
                    });
                } else {
                    console.log("No hay usuarios para mostrar.");
                    // Si no hay usuarios, mostrar un mensaje en la tabla
                    const row = document.createElement('tr');
                    const cell = document.createElement('td');
                    cell.colSpan = 4;
                    cell.textContent = "No has realizado ningun envio.";
                    row.appendChild(cell);
                    contenedor.appendChild(row);
                }
            })
            .catch(error => console.error('Error al obtener los usuarios:', error)); // Manejo de errores si la solicitud falla
    </script>
</body>
</html>
